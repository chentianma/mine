{% extends 'base.html' %}

{% block head %}
    {{ super() }}
{% endblock %}

{% block content %}
    <div id="article">
        <div class="uk-grid">
            <div class="uk-width-medium-9-10 uk-width-small-2-3 uk-margin-top">
                <h2 class="uk-text-center uk-text-muted" v-text="blog.title"></h2>
            </div>
            <div class="uk-width-medium-1-10 uk-width-small-1-3" style="padding-top: 15px">
                {% if current_user.is_authenticated %}
                    <a :href="'/blog/edit/'+blog.id"
                       class="uk-icon-button uk-icon-paint-brush uk-icon-small uk-icon-spin button_shadow" style="background-color: #ffffff;"></a>
                {% endif %}
            </div>
        </div>
        <div class="uk-grid uk-margin-bottom">
            <div class="uk-width-large-1-2 uk-width-medium-1-1">
                <p class="uk-text-center uk-h5">
                    <strong v-text="'发布时间：'"></strong>
                    <em>
                        <small v-text="blog.time"></small>
                    </em>
                </p>
            </div>
            <div class="uk-width-large-1-2 uk-width-medium-1-1">
                <h5 class="uk-text-center uk-h5">
                    <strong v-text="'文章分类：'"></strong>
                    <em>
                        <small v-text="blog.category"></small>
                    </em>
                </h5>
            </div>
        </div>
        <hr>
        <div v-if="blog.text">
            <div v-html="compiledMarkdown"></div>
        </div>
    </div>
{% endblock %}

{% block sidebar %}
    {{ super() }}
{% endblock %}


{% block scripts %}
    {{ super() }}
    <script>
        var art_vm = new Vue({
            el: '#article',
            data: {
                blog: {},
                markhtml: ''
            },
            computed: {
                compiledMarkdown: function () {
                    this.markhtml = marked(this.blog.text);
                    return this.markhtml;

                }
            }
        });

        function initPage() {
            var path = window.location.pathname;
            $.get('/api' + path, function (data, status) {
                art_vm.blog = data.blog;
            });
        }
        ;

        initPage();
    </script>

{% endblock %}